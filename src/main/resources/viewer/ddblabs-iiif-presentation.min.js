let getUrlParameter=function getUrlParameter(sParam){let sPageURL=window.location.search.substring(1),sURLVariables=sPageURL.split('&'),sParameterName,i;for(i=0;i<sURLVariables.length;i++){sParameterName=sURLVariables[i].split('=');if(sParameterName[0]===sParam){return sParameterName[1]===undefined?true:decodeURIComponent(sParameterName[1]);}}};$(document).ready(function(){$("#headerurl").attr("href",Vue.prototype.$javalin.state.baseurl);$('link[rel="shortcut icon"], link[rel="icon"]').attr('href',Vue.prototype.$javalin.state.baseurl+'/favicon.ico');if(getUrlParameter('d')){let dir=getUrlParameter('d');if(dir.includes('/')){dir=dir.substring(0,dir.indexOf('/'));}else if(dir.includes('\\')){dir=dir.substring(0,dir.indexOf('\\'));}else{dir="";}
let newUrl=window.location.origin+window.location.pathname+"?d="+dir;$("#directoryup").attr("href",newUrl).removeClass("d-none");}
if(getUrlParameter('f')){const urlDesc=Vue.prototype.$javalin.state.baseurl+"/api/description?f="+getUrlParameter('f');$("#descriptiontext").load(urlDesc+"&rand="+Math.floor(Math.random()*100000),function(responseText,textStatus){if(textStatus==="success"||textStatus==="notmodified"){$("#descriptiontext").html($.parseJSON(responseText).content);}else{$("#descriptiontext").html("<p>Keine Beschreibung vorhanden.</p>");}
$("#descriptionlink").removeClass("disabled");});const url=Vue.prototype.$javalin.state.baseurl+"/api/file?f="+getUrlParameter('f');$("#sourceframe").load(url+"&rand="+Math.floor(Math.random()*100000),function(responseText,textStatus){if(textStatus==="success"||textStatus==="notmodified"){$("#sourceframe").attr("src",url+"&rand="+Math.floor(Math.random()*100000));$("#sourceframeframe").removeClass("d-none");}else{$("#manifesterrorstext").html($.parseJSON(responseText)['message'].replace("/\n/g","<br />"));$("#manifesterrors").removeClass("d-none");}
$("#apilink").attr("href",url+"&rand="+Math.floor(Math.random()*100000));let dirFilename=getUrlParameter('f');let filename=dirFilename.substr(dirFilename.indexOf('\\')+1,dirFilename.length);$("#apilink").attr("download",filename);$("#manifestlink").removeClass("disabled");});$("#mirador2link").attr("href",Vue.prototype.$javalin.state.baseurl+"/mirador-2.html?manifest="+encodeURIComponent(url)+"&rand="+Math.floor(Math.random()*100000)).removeClass("disabled");$("#mirador3link").attr("href",Vue.prototype.$javalin.state.baseurl+"/mirador-3.html?manifest="+encodeURIComponent(url)+"&rand="+Math.floor(Math.random()*100000)).removeClass("disabled");$("#universalviewerlink").attr("href","https://universalviewer.io/uv.html?manifest="+encodeURIComponent(url)+"&rand="+Math.floor(Math.random()*100000)).removeClass("disabled");$("#tify").attr("href","https://demo.tify.rocks/demo.html?manifest="+encodeURIComponent(url)+"&rand="+Math.floor(Math.random()*100000)).removeClass("disabled");$("#curation").attr("href","http://codh.rois.ac.jp/software/iiif-curation-viewer/demo/?manifest="+encodeURIComponent(url)+"&rand="+Math.floor(Math.random()*100000)).removeClass("disabled");$("#universalviewerdirectlink").attr("href","https://iiif.io/api/presentation/validator/service/validate?format=json&amp;version=2.1&amp;url="+encodeURIComponent(url)+"&rand="+Math.floor(Math.random()*100000)).removeClass("disabled");$("#divajs").attr("href",Vue.prototype.$javalin.state.baseurl+"/diva.js.html?manifest="+encodeURIComponent(url)+"&rand="+Math.floor(Math.random()*100000)).removeClass("disabled");$("#apilinktocopy").val(url);$.getJSON("https://iiif.io/api/presentation/validator/service/validate?format=json&amp;version=2.1&amp;url="+encodeURIComponent(url)+"&rand="+Math.floor(Math.random()*100000),function(data){if($.isArray(data['error'])){let items=[];$.each(data['error'],function(key,val){items.push("<li id=&quot;error-item-"+key+"&quot;>"+val+"</li>");});if(items.length>0){$("#validation-errors").empty();}
$("<ol></ol>",{"class":"validation-error-list",html:items.join("")}).appendTo("#validation-errors");$("#validatorerrors").removeClass("d-none");}else if(data['error']&&data['error']!=="None"){$("#validation-errors").html(data['error']);$("#validatorerrors").removeClass("d-none");}
if($.isArray(data['warnings'])){let items=[];$.each(data['warnings'],function(key,val){items.push("<li id=&quot;warnings-item-"+key+"&quot;>"+val+"</li>");});if(items.length>0){$("#validation-warnings").empty();}
$("<ol></ol>",{"class":"validation-warnings-list",html:items.join("")}).appendTo("#validation-warnings");$("#validatorwarnings").removeClass("d-none");}else if(data['warnings']){$("#validation-warnings").html(data['warnings']);$("#validatorwarnings").removeClass("d-none");}}).done(function(){$("#validatorlink").removeClass("disabled");});$('#collapseTwo3').collapse();}});