$(document).ready(function(){let getUrlParameter=function getUrlParameter(sParam){let sPageURL=window.location.search.substring(1),sURLVariables=sPageURL.split('&'),sParameterName,i;for(i=0;i<sURLVariables.length;i+=1){sParameterName=sURLVariables[i].split('=');if(sParameterName[0]===sParam){return sParameterName[1]===undefined?false:decodeURIComponent(sParameterName[1]);}}
return false;};$("#headerurl").attr("href",Vue.prototype.$javalin.state.baseurl);$('link[rel="shortcut icon"], link[rel="icon"]').attr('href',Vue.prototype.$javalin.state.baseurl+'/favicon.ico');if(dParam=getUrlParameter('d')){if(dParam.includes('/')){dParam=dParam.substring(0,dParam.indexOf('/'));}else if(dParam.includes('\\')){dParam=dParam.substring(0,dParam.indexOf('\\'));}else{dParam="";}
let newUrl=window.location.origin+window.location.pathname+"?d="+encodeURIComponent(dParam);$("#directoryup").attr("href",newUrl).removeClass("d-none");}
if(fParam=getUrlParameter('f')){const randNumber=Math.floor(Math.random()*100000);const urlDesc=Vue.prototype.$javalin.state.baseurl+"/api/description?f="+encodeURIComponent(fParam)+"&rand="+randNumber;$("#descriptiontext").load(urlDesc,function(responseText,textStatus){if(textStatus==="success"||textStatus==="notmodified"){$("#descriptiontext").html($.parseJSON(responseText).content);}else{$("#descriptiontext").html("<p>Keine Beschreibung vorhanden.</p>");}
$("#descriptionlink").removeClass("disabled");});const url=Vue.prototype.$javalin.state.baseurl+"/api/file?f="+encodeURIComponent(fParam)+"&rand="+randNumber;$("#sourceframe").load(url,function(responseText,textStatus){if(textStatus==="success"||textStatus==="notmodified"){$("#sourceframe").attr("src",url);$("#sourceframeframe").removeClass("d-none");}else{$("#manifesterrorstext").html($.parseJSON(responseText)['message'].replace("/\n/g","<br />"));$("#manifesterrors").removeClass("d-none");}
$("#apilink").attr("href",url);const filename=fParam.substr(fParam.indexOf('\\')+1,fParam.length);$("#apilink").attr("download",filename);$("#manifestlink").removeClass("disabled");});const encodedUrl=encodeURIComponent(url);$("#mirador2link").attr("href",Vue.prototype.$javalin.state.baseurl+"/mirador-2.html?manifest="+encodedUrl).removeClass("disabled");$("#mirador3link").attr("href",Vue.prototype.$javalin.state.baseurl+"/mirador-3.html?manifest="+encodedUrl).removeClass("disabled");$("#universalviewerlink").attr("href","https://universalviewer.io/uv.html?manifest="+encodedUrl).removeClass("disabled");$("#tify").attr("href","https://demo.tify.rocks/demo.html?manifest="+encodedUrl).removeClass("disabled");$("#curation").attr("href","http://codh.rois.ac.jp/software/iiif-curation-viewer/demo/?manifest="+encodedUrl).removeClass("disabled");$("#universalviewerdirectlink").attr("href","https://iiif.io/api/presentation/validator/service/validate?format=json&amp;version=2.1&amp;url="+encodedUrl).removeClass("disabled");$("#divajs").attr("href",Vue.prototype.$javalin.state.baseurl+"/diva.js.html?manifest="+encodedUrl).removeClass("disabled");$("#dfgviewer").attr("href","https://dfg-viewer.de/show/?tx_dlf[id]="+encodedUrl).removeClass("disabled");$("#apilinktocopy").val(Vue.prototype.$javalin.state.baseurl+"/api/file?f="+fParam);$("#apilinktocopy").click(function($event){if(navigator.userAgent.match(/Edge\/(13|14|15|16|17)/)){return setTimeout($event.target.select.bind($event.target),10)}
return $event.target.select();});$.getJSON("https://iiif.io/api/presentation/validator/service/validate?format=json&amp;version=2.1&amp;url="+encodedUrl,function(data){if($.isArray(data['error'])){let items=[];$.each(data['error'],function(key,val){items.push("<li id=&quot;error-item-"+key+"&quot;>"+val+"</li>");});if(items.length>0){$("#validation-errors").empty();}
$("<ol></ol>",{"class":"validation-error-list",html:items.join("")}).appendTo("#validation-errors");$("#validatorerrors").removeClass("d-none");}else if(data['error']&&data['error']!=="None"){$("#validation-errors").html(data['error']);$("#validatorerrors").removeClass("d-none");}
if($.isArray(data['warnings'])){let items=[];$.each(data['warnings'],function(key,val){items.push("<li id=&quot;warnings-item-"+key+"&quot;>"+val+"</li>");});if(items.length>0){$("#validation-warnings").empty();}
$("<ol></ol>",{"class":"validation-warnings-list",html:items.join("")}).appendTo("#validation-warnings");$("#validatorwarnings").removeClass("d-none");}else if(data['warnings']){$("#validation-warnings").html(data['warnings']);$("#validatorwarnings").removeClass("d-none");}}).done(function(){$("#validatorlink").removeClass("disabled");});$('#collapseTwo3').collapse();}});